; AutoHotkey v2 Script for Anki Global Hotkeys
; Generated by Anki Global Hotkey Card Control addon

; Global hotkeys for Anki card review
; These work regardless of which window has focus
; Uses PostMessage to send Windows messages to Anki process
; Message codes: 0x464 (Good), 0x465 (Again), 0x466 (Toggle Top)

; Ctrl+Z -> Score card as Good
^z::
{
    ; Check if Anki is running
    if (WinExist("ahk_exe anki.exe"))
    {
        ; Send custom Windows message for "Good" score
        ; WM_USER + 100 = 0x464 for Good action
        ; Send both KEYDOWN and KEYUP messages
        PostMessage, 0x464, 1, 0,, ahk_exe anki.exe  ; Custom message for Good score
    }
}

; Ctrl+X -> Score card as Again
^x::
{
    ; Check if Anki is running
    if (WinExist("ahk_exe anki.exe"))
    {
        ; Send custom Windows message for "Again" score
        ; WM_USER + 101 = 0x465 for Again action
        PostMessage, 0x465, 1, 0,, ahk_exe anki.exe  ; Custom message for Again score
    }
}

; Ctrl+O -> Toggle always on top
^o::
{
    ; Check if Anki is running
    if (WinExist("ahk_exe anki.exe"))
    {
        ; Send custom Windows message for toggle always on top
        ; WM_USER + 102 = 0x466 for toggle always on top action
        PostMessage, 0x466, 1, 0,, ahk_exe anki.exe  ; Custom message for toggle always on top
    }
}

; Exit hotkey for cleanup (Ctrl+Alt+Q)
^!q::ExitApp()

; Test hotkey for debugging (Ctrl+Alt+T)
^!t::
{
    ; Send a simple message box to verify AHK is working
    if (WinExist("ahk_exe anki.exe"))
    {
        MsgBox("AutoHotkey script is running! Process ID: " . ProcessExist() . "`nAnki process found - PostMessage ready!")
    }
    else
    {
        MsgBox("AutoHotkey script is running! Process ID: " . ProcessExist() . "`nWarning: Anki process not found!")
    }
}